macro(build_example name)
   add_executable("example_${name}_default" ${ARGN})
   add_target_property("example_${name}_default" LABELS "other")
   add_dependencies(other "example_${name}_default")
   target_link_libraries("example_${name}_default" Vc)

   add_executable("example_${name}_scalar" ${ARGN})
   add_target_property("example_${name}_scalar" COMPILE_FLAGS "-DVC_IMPL=Scalar")
   add_target_property("example_${name}_scalar" LABELS "Scalar")
   add_dependencies(Scalar "example_${name}_default")
   target_link_libraries("example_${name}_scalar" Vc)

   if(USE_SSE2)
      add_executable("example_${name}_sse" ${ARGN})
      add_target_property("example_${name}_sse" COMPILE_FLAGS "-DVC_IMPL=SSE")
      add_target_property("example_${name}_sse" LABELS "SSE")
      add_dependencies(SSE "example_${name}_default")
      target_link_libraries("example_${name}_sse" Vc)
   endif()

   if(USE_AVX)
      add_executable("example_${name}_avx" ${ARGN})
      add_target_property("example_${name}_avx" COMPILE_FLAGS "-DVC_IMPL=AVX")
      add_target_property("example_${name}_avx" LABELS "AVX")
      add_dependencies(AVX "example_${name}_default")
      target_link_libraries("example_${name}_avx" Vc)
   endif()

   if(LARRABEE_FOUND)
      add_executable("example_${name}_lrbni" ${ARGN})
      add_target_property("example_${name}_lrbni" COMPILE_FLAGS "-DVC_IMPL=LRBni")
      add_target_property("example_${name}_lrbni" LABELS "LRBni")
      add_dependencies(LRBni "example_${name}_default")
      target_link_libraries("example_${name}_lrbni" Vc)
   endif()
endmacro(build_example)

add_subdirectory(polarcoord)
add_subdirectory(matrix)
add_subdirectory(mandelbrot)
add_subdirectory(buddhabrot)
add_subdirectory(finitediff)
